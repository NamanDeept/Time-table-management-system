YUI.add("murmurhash",function(h){h.murmurhash=function(h,r){var a,e,t,c,o,d,n,u;for(a=3&h.length,e=h.length-a,t=r,o=3432918353,d=461845907,u=0;u<e;)n=255&h.charCodeAt(u)|(255&h.charCodeAt(++u))<<8|(255&h.charCodeAt(++u))<<16|(255&h.charCodeAt(++u))<<24,++u,t=27492+(65535&(c=5*(65535&(t=(t^=n=(65535&(n=(n=(65535&n)*o+(((n>>>16)*o&65535)<<16)&4294967295)<<15|n>>>17))*d+(((n>>>16)*d&65535)<<16)&4294967295)<<13|t>>>19))+((5*(t>>>16)&65535)<<16)&4294967295))+((58964+(c>>>16)&65535)<<16);switch(n=0,a){case 3:n^=(255&h.charCodeAt(u+2))<<16;case 2:n^=(255&h.charCodeAt(u+1))<<8;case 1:t^=n=(65535&(n=(n=(65535&(n^=255&h.charCodeAt(u)))*o+(((n>>>16)*o&65535)<<16)&4294967295)<<15|n>>>17))*d+(((n>>>16)*d&65535)<<16)&4294967295}return t^=h.length,t^=t>>>16,t=2246822507*(65535&t)+((2246822507*(t>>>16)&65535)<<16)&4294967295,t^=t>>>13,t=3266489909*(65535&t)+((3266489909*(t>>>16)&65535)<<16)&4294967295,(t^=t>>>16)>>>0}},"@VERSION@");YUI.add("moola-manager",function(t,e){"use strict";function r(e,r){var i;this.initialAdShown=!1,this.adCouldBeShown=!1,this.dwellTime=0,this.contextOwnerIsPro=!1,this.origin={},this.context={},this.timeoutID=0,this.adCallsCounter=0,this.currentlyShowingAd=!1,this.adPosition=1,e&&r?(this.referrer=e,this.appContext=r):o.error("Attempt to instantiate moola-manager without appContext/referrer"),i=function(e){var r={};e.origin===t.url()&&"string"==typeof e.data&&e.data.split&&(e.data.split("&").map(function(t){var e=t.split("=");r[e[0]]=e[1]}),"true"===r.no_ad?t.fire("no_ad_event",r.ad_id):t.fire("ad_event",r.ad_id))},t.config.win&&t.config.win.addEventListener("message",i,!1)}var o=require("hermes-core/flog")(e);r.prototype.markAdAsSeen=function(){this.initialAdShown=!0,this.resetPhotoAdsCounter(),this.adCallsCounter--},r.prototype.beaconDwellTime=function(){var e=Date.now()-this.dwellTime;this.dwellTime=0,t.rapidTracker.beacon(this.name,"adDwellTime",{dwell:e})},r.prototype.adIsUnloading=function(){this.beaconDwellTime(),clearTimeout(this.timeoutID),this.currentlyShowingAd=!1},r.prototype.adIsLoading=function(){this.currentlyShowingAd=!0},r.prototype.isEnabled=function(){return!(this.appContext.forceServerRender||this.appContext.flipper.isFlipped("moola_killswitch")||this.appContext.getViewer().signedIn&&this.appContext.getViewer().isPro)},r.prototype.adNext=function(){var e,r,o,i,n,a;return!(YUI.Env.isServer||!this.context.current)&&(this.adPosition++,e=this.isEnabled(),r=this.adCouldBeShown,i=this.enoughPhotoViewsAccrued(),o=this.contextOwnerIsPro,n=this.adjacentPhotosAreAdFriendly(),a=this.referrerIsBlacklisted(),e&&r&&i&&!o&&n&&!a&&t.rapidTracker.beacon(this.name,"adSlotAvailable"),e&&r&&!o&&i&&n&&!a)},r.prototype.resetPhotoAdsCounter=function(){t.Cookie.set("adCounter",0,{path:"/",domain:"flickr.com"})},r.prototype.enoughPhotoViewsAccrued=function(){var e=t.Cookie.get("adCounter",Number),r=this.getThreshold();return(e=e||0)>=r},r.prototype.adjacentPhotosAreAdFriendly=function(){return"next"===this.origin.arrow?this.context.next.adFriendly&&this.context.current.adFriendly:this.context.previous.adFriendly&&this.context.current.adFriendly},r.prototype.referrerIsBlacklisted=function(){var t=[];return this.appContext.getViewer().signedIn||t.push("/"),t.indexOf(this.appContext.getPreviousURL())>-1},r.prototype.setAdCouldBeShown=function(t,e,r){void 0===t&&(t=!1),e&&r?(this.origin.arrow=e,this.origin.url=r):t&&(o.info("Attempt to schedule an ad without setting nav direction or URL"),t=!1),this.adCouldBeShown=t},r.prototype.updateContext=function(e){var r;this.contextOwnerIsPro=!1,(-1!==t.Array.indexOf(["photostream-models","set-models","photoList-models"],e.type)||/^\/search\/\?.+=[0-9]+@N[0-9]{2}.*/.test(e.entryURL))&&(r=e.current.getValue("owner"))&&(this.contextOwnerIsPro=r.getValue("isPro")),this.context.previous=this.extractKeyDataFromPhotoModel(e.prev),this.context.current=this.extractKeyDataFromPhotoModel(e.current),this.context.next=this.extractKeyDataFromPhotoModel(e.next)},r.prototype.getThreshold=function(){var e;try{e=this.initialAdShown?t.config.flickr.moola.threshold[this.referrer].subsequent:t.config.flickr.moola.threshold[this.referrer].initial}catch(t){o.info("There is no matching value for referrer in the ad/referrer config",{referrer:this.referrer,err:t}),e=100}return e},r.prototype.updatePhotoAdsCounter=function(){var e=t.Cookie.get("adCounter",Number);return e=e||0,t.Cookie.set("adCounter",++e,{path:"/",domain:"flickr.com"}),e},r.prototype.extractKeyDataFromPhotoModel=function(t){var e={};return t&&(e={adFriendly:0===t.getValue("safetyLevel"),url:this.getBackgroundImage(t),link:t.getValue("url")}),e},r.prototype.getBackgroundImage=function(t){var e,r,o,i={height:40,width:101};return r=this.appContext.getViewer().getPixelRatio(),e={width:i.width*r,height:i.height*r},o={cropToFit:!0,includeSizes:["sq","t","q","s","n"]},t.getSizeToFit(e,o).url},t.namespace("AdManager"),t.AdManager=r},"@VERSION@",{requires:["cookie","io-base","json-parse","murmurhash","url"]});YUI.add("viewport-data",function(t){"use strict";var i=function(i){var e,o,n,r=this;r.appContext=i,(e=i.getCookie("vp"))&&((o=e.split(",")).length>4?(this.containerWidths=o.slice(4),this.containerWidths=this.containerWidths.map(function(t){return n=t.split(":"),{name:n[0],width:n[1]}})):this.containerWidths=[]),YUI.Env.isServer?e?(this.viewport={width:parseInt(o[0],10),height:parseInt(o[1],10)},this.density=o[2]?parseFloat(o[2]):1,this.scrollbarWidth=o[3]?parseInt(o[3],10):16):(this.viewport={width:0,height:0},this.density=1,this.scrollbarWidth=16,this.containerWidths=[]):(t.config.win&&(r.density=t.config.win.devicePixelRatio||1,r.scrollbarWidth=t.OverflowHelper.detectScrollbarSize(t.one("body"))),r.setCookieWithCurrentViewportRegion(),r.containerWidths||(r.containerWidths=[]),t.globalEvents.subscribe("window:resize",function(t){r.setCookieWithCurrentViewportRegion()}))};i.VIEWPORT_COOKIE_NAME="vp",i.MAX_NUM_CONTAINER_WIDTHS=20,i.prototype.setCookie=function(){var i,e;!this.viewport.width||this.viewport.width<0||!this.viewport.height||this.viewport.height<0||(i=this.viewport.width+","+this.viewport.height+","+this.density+","+this.scrollbarWidth,t.Lang.isArray(this.containerWidths)&&(e=this.containerWidths.reduce(function(t,i,e,o){return t+=i.name+":"+i.width,e<o.length-1&&(t+=","),t},""))&&(i=i+","+e),this.appContext.setCookie({cookieName:"vp",cookieValue:i,path:"/",expiresMonthsFromNow:1}))},i.prototype.setCookieWithCurrentViewportRegion=function(){this.viewport=t.DOM.viewportRegion(),this.setCookie()},i.prototype.getWidth=function(){return this.viewport.width},i.prototype.getHeight=function(){return this.viewport.height},i.prototype.getDevicePixelRatio=function(){return this.density},i.prototype.getScrollbarWidth=function(){return this.scrollbarWidth},i.prototype.getCommonMobileViewportWidth=function(){return 320},i.prototype.getContainerWidth=function(t){var i=0;return this.containerWidths.some(function(e){if(e.name===t)return i=parseInt(e.width,10),!0}),i},i.prototype.setContainerWidth=function(t,e){this.containerWidths.length>=i.MAX_NUM_CONTAINER_WIDTHS&&(this.containerWidths=this.containerWidths.slice(this.containerWidths.length-i.MAX_NUM_CONTAINER_WIDTHS+1)),this.containerWidths.some(function(i){if(i.name===t)return i.width=e,!0})||this.containerWidths.push({name:t,width:e}),this.setCookie()},t.ViewportData=i},"@VERSION@");YUI.add("querystring-parse-simple",function(e,t){var n=e.namespace("QueryString");n.parse=function(e,t,r){t=t||"&",r=r||"=";for(var i={},s=0,o=e.split(t),u=o.length,a;s<u;s++)a=o[s].split(r),a.length>0&&(i[n.unescape(a.shift())]=n.unescape(a.join(r)));return i},n.unescape=function(e){return decodeURIComponent(e.replace(/\+/g," "))}},"3.16.0",{requires:["yui-base"]});
YUI.add("browser-support",function(e,r){var o="Google Page Speed Insights",i=new RegExp(["UP\\.Link","UP\\.Browser","Profile\\/MIDP-","MMP\\/","NetFront","BlackBerry","Danger hiptop","Windows CE","MMP\\/","MIDP","Palm","Nokia","Symbian","iPhone","iPod","Android.+Mobile","Mobile.+Firefox","BB10.+Mobile","webOS","SAMSUNG.+Mobile Safari","SEC_.+Mobile Safari",o+".+Mobile"].join("|"),"i"),n=new RegExp([o].join("|"),"i"),t=new RegExp(["Edge"].join("|"),"i"),s=["facebot","facebook","facebookexternalhit","twitterbot","twitter","pinterest"],a=["bot","crawl","slurp","spider"],u=/Windows NT (?:(?:4|5)\.\d|6\.(?:0|1))/i,c=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i,f="Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729)",d=function(e){var r;try{r=YUI.Env.parseUA(e)}catch(e){}return r&&r.userAgent?r.userAgent.toLowerCase():""},p=function(e,r){var o,i=!1;if(void 0===e||""===e)return!0;if(r)for(o in r)void 0!==r[o]&&!isNaN(r[o])&&r[o]>0&&(i=!0);return!i};e.mix(e.namespace("BrowserSupport"),{isUnsupportedBrowser:function(e){var r,o=!1;try{r=YUI.Env.parseUA(e)}catch(e){}return!p(e,r)&&(r.safari>=536||r.chrome>=20||r.gecko>=24||r.opera>=15||"android"===r.os||"ios"===r.os&&r.ios>=6||r.ie>11||(o=!0),n.test(r.userAgent)&&(o=!1),e===f||o)},isReallyUnsupportedBrowser:function(e){var r,o=!1;try{r=YUI.Env.parseUA(e)}catch(e){}return!p(e,r)&&(r.safari>=533.21||r.chrome>=13||r.gecko>=2||(e||"").indexOf("Firefox/4.0")>-1||r.opera>=12||"android"===r.os||"ios"===r.os&&r.ios>=4||r.ie>=9||(o=!0),e!==f&&o)},isMobileBrowser:function(e){try{var r=YUI.Env.parseUA(e);return!r.ipad&&((!r.mobile||!/Nexus 10/.test(r.userAgent))&&(!!r.mobile||i.test(r.userAgent)))}catch(e){}return!1},isMobileOrTablet:function(e){try{var r=YUI.Env.parseUA(e);return!!r.mobile||i.test(r.userAgent)}catch(e){}return!1},isBot:function(e){var r,o=!1;return r=d(e),a.some(function(e){return r.indexOf(e)>-1&&(o=!0,!0)}),o},isSharingBot:function(e){var r,o=!1;return r=d(e),s.some(function(e){return r.indexOf(e)>-1&&(o=!0,!0)}),o},isFacebook:function(e){var r=!1;return d(e).indexOf("facebookexternalhit/1.1")>-1&&(r=!0),r},getOSString:function(e){var r,o="";try{r=YUI.Env.parseUA(e)}catch(e){}return e&&e.indexOf("Windows Phone")>-1?o="windows":r&&r.os&&(o=r.os.toLowerCase()),o},isWebview:function(e){return c.test(e)},isGooglePageSpeedToolMobile:function(e){return new RegExp(o+".+Mobile").test(e)},isGooglePageSpeedToolDesktop:function(e){return new RegExp(o).test(e)},isEdge:function(e){return new RegExp(t).test(e)},isOldWindows:function(e){return u.test(e)}})},"@VERSION@",{requires:[]});YUI.add("app-context",function(e,i){var t,o=require("hermes-core/flog")(i),n=require("hermes-core/fletrics"),r=YUI.Env.isServer?e.config.flickr.api.server_default_timeout:e.config.flickr.api.client_default_timeout,s=YUI.Env.isServer?e.config.flickr.api.server_retry_timeout:e.config.flickr.api.client_retry_timeout,a=[117,118,119],l=new RegExp(e.config.flickr.api.write_api_method_regex),c=e.config.flickr.model_eviction,h={};(t=e.AppContext=function(i){(i=i||{}).request&&(this.request=i.request),this.params={},this._initializeParams(i),this.viewTiming={},this.modelRegistries={},this.modelImportExport=new e.ModelImportExport(this),this.flickrAPI=new e.FlickrAPI(this.request,this),this.auth=i.auth,this.flapp=i.flapp,this.writeAPICallsMadeOnThisPage={},this._moduleInstances={},this._pendingYUIPromises={},this._loadedViews={},this._apiCalls={},this._previousLocation=null,this._uploadInProgress=!1,this._pendingUploadErrorModal=null,this._concurrentAPICalls=0,this._apiQueueOrder=[],this._apiQueueFunctions={},this._preliminaryNsid=null,this.flipper=new e.Flipper(i.flipper),this.experiments={fullscreen:new e.Experiments.Fullscreen(this),optOut:new e.Experiments.OptOut(this)},this.secure="https"===this.protocol,this.adManager=new e.AdManager(this.params.referrer,this),this.viewportData=new e.ViewportData(this),this.clientId="f"+Math.round(1e4*Math.random()).toString(36),this.isCSSLoaded=!1,this.initGlobalEvictionExemptionConfig()}).getValidParams=function(){return["bucket","protocol","buckets","slice","random_slice","referrer","flipper","lang","gp_code","gp_owner","share_code"]},t.prototype={routeConfig:{},_initializeParams:function(e){var i=this;t.getValidParams().forEach(function(t){e.request&&t in e.request&&(e[t]=e.request[t]),t in e&&(i[t]=e[t],i.params[t]=e[t])})},instantiateYUIModule:function(i,t){if(!e.Lang.isString(i)||!e.Lang.isFunction(t))return e.Promise.reject("[app-context] `instantiateYUIModule` called without a `name` or `initializer`.");var o,n=this._moduleInstances,r=this._pendingYUIPromises;return r[i]||(n[i]?r[i]=e.Promise.resolve(n[i]):(o=YUI.Env.isServer?this.request.app.yui:e,r[i]=e.betterUse(i,o).then(function(){var e=t();return n[i]=e,delete r[i],e}))),r[i]},getModelRegistry:function(i){if(!e.Lang.isString(i))return e.Promise.reject("[app-context] `getModelRegistry` called without a `name`.");var t,r=this;return this.instantiateYUIModule(i,function(s){if(!e.Models||!e.Models[i]||"function"!=typeof e.Models[i])throw o.error("There was an error loading the modelregistry",{status:s}),n.increment("appContext.getmodelregistry.failures"),t=new Error("[app-context] - Model registry failed to load:"+i),t.moduleLoadingError=!0,t;var a=new e.Models[i](r);return r.modelRegistries[i]=a,a})},getModel:function(i,t,o){return e.Lang.isString(i)&&t?this.getModelRegistry(i).then(function(i){return this._refetchExistingModels&&(e.Lang.isObject(t,!0)?i.attributeSearch(t):[t]).forEach(function(e){this.canEvictModel(i,e)&&this.evictModel(i,e)}.bind(this)),i.get(t,o)}.bind(this)):e.Promise.reject("[app-context] `getModelRegistry` called without a `registryName` or `modelId`.")},markAsNewlyFetched:function(e,i){this._refetchExistingModels&&(this._refetchedModels[e]||(this._refetchedModels[e]={}),this._refetchedModels[e][i]=!0)},getRoute:function(i){var t,r=this;return this.instantiateYUIModule(i,function(s){if(!e.Routes||!e.Routes[i]||"function"!=typeof e.Routes[i])throw o.error("There was an error loading the route",{status:s}),n.increment("appContext.getroute.failures"),t=new Error("[app-context] - Route failed to load:"+i),t.moduleLoadingError=!0,t;return new e.Routes[i](r)})},getView:function(i,t,r){var s,a=this,l=YUI.Env.isServer?a.request.app.yui:e,c=[i];return t=t||{},t.appContext=a,e.betterUse(c,l).then(function(r){if(!e.Views||!e.Views[i]||"function"!=typeof e.Views[i])throw o.error("There was an error loading the view",{status:r}),n.increment("appContext.getview.failures"),s=new Error("[app-context] - View failed to load:"+i),s.moduleLoadingError=!0,s;return a._loadedViews[i]=!0,new e.Views[i](t)})},getLoadedViews:function(){return Object.keys(this._loadedViews)},setGPCredentials:function(e){null===e?(delete this.params.gp_owner,delete this.params.gp_code,delete this.params.share_code,delete h.gp_owner,delete h.gp_code,delete h.share_code,o.info("Setting GP credentials to null")):null!==e&&e.gp_code&&(this.params.gp_owner=e.gp_owner,this.params.gp_code=e.gp_code,this.params.share_code=e.share_code,h.gp_owner=e.gp_owner,h.gp_code=e.gp_code,h.share_code=e.share_code,o.info("Setting GP credentials to "+e.share_code))},getCookie:function(i){return YUI.Env.isServer?this.request.cookies[escape(i)]:e.Cookie.get(i)},setCookie:function(i){if(YUI.Env.isServer)o.warn("You can't set a cookie from the server with AppContext -- use middleware.",i);else{i.cookieName&&void 0!==i.cookieValue&&i.path||o.error("Missing important parameters to set a cookie");var t=i.cookieName,n=i.cookieValue,r=i.domain||".flickr.com",s=i.path,a=i.expiresMonthsFromNow||3,l=i.expires?i.expires:e.moment().add(a,"months").toDate();i.remove&&e.Cookie.remove(t,{domain:i.domain||".flickr.com",path:s}),e.Cookie.set(t,n,{domain:r,path:s,expires:l})}},removeCookie:function(i){YUI.Env.isServer?o.warn("You can't remove a cookie from the server with AppContext -- use middleware.",i):(i.cookieName&&i.path||o.error("Missing important parameters to remove a cookie"),e.Cookie.remove(i.cookieName,{domain:i.domain||".flickr.com",path:i.path}))},getViewer:function(){var e={},i=this;return e.getPixelRatio=function(){var e;return(e=YUI.Env.isServer?i.getCookie("density"):window.devicePixelRatio)||(e=1),e},this.auth&&this.auth.signedIn?(e.nsid=this.auth.user.nsid,e.intl=this.auth.intl,e.signedIn=this.auth.signedIn,e.isInsecureGod=this.auth.isInsecureGod,e.isMinor=this.auth.isMinor,e.isPro=this.auth.user.ispro,e.canReact=this.auth.canReact,e.isCognitoUser=this.auth.isCognitoUser,e.prefs={timezonePref:this.auth.timezonePref,downloadAccessPref:this.auth.downloadAccessPref}):this._preliminaryNsid?(e.nsid=this._preliminaryNsid,e.signedIn=!0):(e.signedIn=!1,e.prefs={timezonePref:{name:"",dst:!1,offset:"+00:00",isDefaults:!0}}),e},setPreliminaryViewerNsid:function(e){this._preliminaryNsid=e},getKeyboardManager:function(){return this._keyboardManager||(this._keyboardManager=new e.KeyboardManager),this._keyboardManager},initGlobalEvictionExemptionConfig:function(){var e=this.getViewer().nsid;this._globalEvictionExemptionConfig={},e&&(this._globalEvictionExemptionConfig["person-preferences-models"]={exemptIds:[e]})},getPreviousURL:function(){var e="";return this._previousLocation&&(e=this._previousLocation.pathname,this._previousLocation.querystring&&(e+="?"+this._previousLocation.querystring),this._previousLocation.hash&&(e+="#"+this._previousLocation.hash)),e},getPreviousLocation:function(){return e.merge(this._previousLocation)},setPreviousLocation:function(){this._previousLocation=this.getLocation()},updateModelRefetchState:function(i,t){if(!this.flipper.isFlipped("evict-models-on-navigate")||!i||t)return this._refetchExistingModels=!1,void(this._refetchedModels=null);var o,n;this._previousLocation&&(o=e.URLHelper.getSiteSectionByURL(this._previousLocation.pathname)),i&&(i="/"+i.split("/").slice(3).join("/"),n=e.URLHelper.getSiteSectionByURL(i)),this._refetchExistingModels=void 0,n&&c.entry_refetch_exemptions[n.name]&&(this._refetchExistingModels=!1),o&&c.exit_refetch_exemptions[o.name]&&(this._refetchExistingModels=!1),void 0===this._refetchExistingModels&&n&&o&&(c.transition_refetch_exemptions[o.name]&&c.transition_refetch_exemptions[o.name][n.name]?this._refetchExistingModels=!1:this._refetchExistingModels=o.name!==n.name),void 0===this._refetchExistingModels&&(this._refetchExistingModels=!1),this._refetchedModels={}},hasClientSideRouted:function(){return!!this._clientSideRouted},setClientSideRouted:function(e){this._clientSideRouted=e},getReferrer:function(){var e;try{e=this.flapp.get("activeView").getViewDataFromHistory("referrer")}catch(e){}return e},getLocation:function(){var i;return YUI.Env.isServer?(i={protocol:this.request.protocol,hostname:this.request.hostname,pathname:this.request.path,query:this.request.query,querystring:this.request.query?e.QueryString.stringify(this.request.query):"",hash:""}).href=i.protocol+"://"+i.hostname+this.request.originalUrl:(i={protocol:e.config.win.location.protocol.split(":")[0],hostname:e.config.win.location.hostname,pathname:e.config.win.location.pathname,querystring:e.config.win.location.search.split("?")[1],href:e.config.win.location.href,hash:e.config.win.location.hash}).query=i.querystring?e.QueryString.parse(i.querystring):"",i},getViewCounter:function(){return this._viewCounter||(this._viewCounter=new e.ViewCounter({appContext:this})),this._viewCounter},getBucket:function(e){if(this.buckets)return this.buckets[e]},handleMismatchedNSID:function(){var i,t;i=e.mix({langBundles:["common"],appContext:this},e.Localizable),(t=new e.Views.FluidModal({title:i.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:i.intlMessage({intlName:"common.OK"}),textMessage:i.intlMessage({intlName:"common.MISMATCHED_NSID_ERROR"}),appContext:this,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0})).on("actionClick",function(i){e.config.win.location.reload(!0)}),t.show()},mitigateClientPanda:function(i){var t,o;return t=e.mix({langBundles:["common"],appContext:this},e.Localizable),(o=new e.Views.FluidModal({title:t.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:t.intlMessage({intlName:"common.OK"}),htmlMessage:t.intlMessage({intlName:i}),appContext:this,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0})).on("actionClick",function(i){e.config.win.location.reload(!0)}),o.show(),e.PromiseChainDestroyer()},callAPI:function(i,t,n,c){var u,d,p,f=this,g=[i,t,null,c];return n=n&&!YUI.Env.isServer,g=null!==h?[i,e.merge(t,h),null,c]:[i,t,null,c],u=i+"__"+Object.keys(t).sort().map(function(e){return encodeURIComponent(e)+"_"+encodeURIComponent(t[e])}).join("__"),this._apiCalls[u]?(e.config.flickr.cameraroll.suppress_logging&&"flickr.cameraroll.getPhotosByOffset"===i||o.log("Reusing API call",{method:i}),f._apiQueueOrder.length>1&&(p=f._apiQueueOrder.indexOf(u))>-1&&p<f._apiQueueOrder.length-1&&(f._apiQueueOrder.splice(p,1),f._apiQueueOrder.push(u)),this._apiCalls[u].then(function(i){return e.clone(i,!0)},function(i){throw e.clone(i,!0)})):(n&&(g.push(null),g.push({timeout:r})),i.match(l)&&this.cacheWriteAPICall(u,i),this._apiCalls[u]=new e.Promise(function(t,r){var l;l=function(){f.flickrAPI.callMethod.apply(f.flickrAPI,g).then(function(e){return f.onAPICallComplete(u,!0),e},function(t){if(f.onAPICallComplete(u,!1),f.flipper.isFlipped("enable-viewer-nsid-check")&&!YUI.Env.isServer&&-1!==a.indexOf(t.code))return f.handleMismatchedNSID(),e.PromiseChainDestroyer();if(!YUI.Env.isServer&&0===t.status&&0===t.total)return f.mitigateClientPanda("common.NETWORK_CONNECTIVITY_ISSUE");if(n&&(t.clientTimeout||0===t.status||t.transportFailure)){if(o.log("Retrying API call",{method:i}),delete f._apiCalls[u],!YUI.Env.isServer&&e.config.win.beaconError){if(e.config.win.document)try{t.domain=e.config.win.document.domain}catch(e){}e.config.win.beaconError("[app-context] Retrying API ",e.config.win.location.href,t)}return(d=g[g.length-1]).timeout&&(d.timeout=s),f._apiCalls[u]=f.flickrAPI.callMethod.apply(f.flickrAPI,g).then(function(t){return f.onAPICallComplete(u,!0),o.log("Successfully retried API call",{method:i}),e.fire("appContext:apiRetry",{apiMethod:i,code:418}),!YUI.Env.isServer&&e.config.win.beaconError&&e.config.win.beaconError("[app-context] Successful API retry ",e.config.win.location.href,{}),t},function(t){throw f.onAPICallComplete(u,!1),o.log("Failed retry of API call",{method:i}),e.fire("appContext:apiRetry",{apiMethod:i,code:408}),!YUI.Env.isServer&&e.config.win.beaconError&&e.config.win.beaconError("[app-context] Failed API retry ",e.config.win.location.href,{}),t}),f._concurrentAPICalls++,f._apiCalls[u]}throw t}).then(t,r)},YUI.Env.isServer?l():(f._apiQueueOrder.push(u),f._apiQueueFunctions[u]=l,f.callNextInQueue())}),this._apiCalls[u])},callNextInQueue:function(){var i,t,o=e.config.flickr.api.max_concurrent_api_calls;this._apiQueueOrder.length&&this._concurrentAPICalls<o&&(this._concurrentAPICalls++,i=this._apiQueueOrder.pop(),t=this._apiQueueFunctions[i],delete this._apiQueueFunctions[i],t())},cacheWriteAPICall:function(e,i){this.writeAPICallsMadeOnThisPage[e]={methodName:i,completed:!1,failed:!1}},onAPICallComplete:function(e,i){var t=this.writeAPICallsMadeOnThisPage[e];t&&(t.completed=!0,t.failed=!i),delete this._apiCalls[e],this._concurrentAPICalls--,this.callNextInQueue()},clearWriteAPICallCache:function(){this.writeAPICallsMadeOnThisPage={}},canEvictModel:function(e,i){var t,o;return!(!e||!i)&&(!!e.exists(i)&&(t=e.name,o=this._globalEvictionExemptionConfig[t],!(o&&o.exemptIds&&-1!==o.exemptIds.indexOf(i))&&(this._refetchedModels[t]||(this._refetchedModels[t]={}),!this._refetchedModels[t][i])))},evictModel:function(e,i){var t=e.name;this.flipper.isFlipped("model-eviction-debugging")&&console.log("[EVICT] "+t+" ["+i+"]"),e.getOwnedModels(i).forEach(function(e){this.canEvictModel(e.registry,e.id)&&this.evictModel(e.registry,e.id)}.bind(this)),e.remove(i)},evictModels:function(i){var t,n,r,s,a=this.getViewer().nsid,l=[],c=this.modelRegistries;for(t in this.writeAPICallsMadeOnThisPage)(n=this.writeAPICallsMadeOnThisPage[t]).completed&&!n.failed&&l.push(n);l.forEach(function(e){}),this._refetchExistingModels&&(a&&(i=e.merge(i,this._globalEvictionExemptionConfig)),Object.keys(this.modelRegistries).forEach(function(e){r=c[e],(s=i[e])?s.exemptIds?(s.evictIds&&o.warn("Error in eviction config for registry: cannot specify both a whitelist (`evictIds`) and a blacklist (`exemptIds`) for model eviction. Ignoring `evictIds` and evicting all models except those listed in `exemptIds`.",{modelRegistryName:e}),r.removeAllExcept(s.exemptIds)):s.evictIds&&s.evictIds.forEach(function(i){c[e].remove(i)}):c[e].removeAll()}))},markUploadInProgress:function(e){this._uploadInProgress=e},uploadIsInProgress:function(){return this._uploadInProgress},storePendingUploadErrorModal:function(e){this._pendingUploadErrorModal=e},retrievePendingUploadErrorModal:function(e){return this._pendingUploadErrorModal},_doForcedServerRender:function(){if(!YUI.Env.isServer||!this.request||!this.request.headers)return!1;var e=!1;return e=e||this.request.UA.isBot,e=e||this.request.UA.isSharingBot,this.flipper.isFlipped("enable-server-render-for-unsupported-browsers")&&(e=e||this.request.UA.isUnsupportedBrowser),this.flipper.isFlipped("enable-forced-server-render")&&(e=!0),e},getUA:function(){return YUI.Env.isServer?this.request.UA:e.config.flickr.request.UA},logViewTiming:function(){var e,i=this.flapp.get("activeView"),t=0,o=this;e=function(i,n){t++,Object.keys(i.subviews).forEach(function(r){var s=i.subviews[r].get("container").hasClass("requiredToShowOnServer")||i.subviews[r]._params.requiredToShowOnClient,a=n&&s,l="-";l=s?"ðŸ”¹":"-",l=a?"ðŸ”·":l,console.log("| \t\t "+new Array(t).join(" |\t\t ")+" "+l+" "+r+" (initialization: "+o.viewTiming[r].initialize+"ms) (loadState: "+o.viewTiming[r].loadState+"ms)"),e(i.subviews[r],a)}),t--},console.log(this.routeConfig.module+": "+this.routeTiming+"ms"),console.log("ðŸ”· "+i.name+" (initialization: "+this.viewTiming[i.name].initialize+"ms) (loadState: "+this.viewTiming[i.name].loadState+"ms)"),e(i,!0)}}},"@VERSION@",{requires:["oop","flickr-api","flickr-promise","promise","model-import-export","cookie","better-use","view-counter","flipper","localizable","moment","experiments-fullscreen","experiments-opt-out","moola-manager","viewport-data","querystring-parse-simple","querystring-stringify-simple","url-helper","browser-support","api-helper"]});YUI.add("querystring-stringify",function(e,t){var n=e.namespace("QueryString"),r=[],i=e.Lang;n.escape=encodeURIComponent,n.stringify=function(e,t,s){var o,u,a,f,l,c,h=t&&t.sep?t.sep:"&",p=t&&t.eq?t.eq:"=",d=t&&t.arrayKey?t.arrayKey:!1;if(i.isNull(e)||i.isUndefined(e)||i.isFunction(e))return s?n.escape(s)+p:"";if(i.isBoolean(e)||Object.prototype.toString.call(e)==="[object Boolean]")e=+e;if(i.isNumber(e)||i.isString(e))return n.escape(s)+p+n.escape(e);if(i.isArray(e)){c=[],s=d?s+"[]":s,f=e.length;for(a=0;a<f;a++)c.push(n.stringify(e[a],t,s));return c.join(h)}for(a=r.length-1;a>=0;--a)if(r[a]===e)throw new Error("QueryString.stringify. Cyclical reference");r.push(e),c=[],o=s?s+"[":"",u=s?"]":"";for(a in e)e.hasOwnProperty(a)&&(l=o+a+u,c.push(n.stringify(e[a],t,l)));return r.pop(),c=c.join(h),!c&&s?s+"=":c}},"3.16.0",{requires:["yui-base"]});
YUI.add("better-cache",function(e){function c(e,c){return e.score<c.score?-1:e.score>c.score?1:0}function t(){var e,t,o;for(r.sort(c),u={},r.length>n&&(o=r.shift()).callback&&o.callback(),e=r.length,t=0;t<e;t++)u[r[t].key]=t}var n,r=[],o=0,u={};n=e.config.flickr.better_cache_size||100,e.betterCache={reset:function(){r=[],o=0,u={}},_cache:r,getSize:function(){return r.length},unset:function(e){var c=u[e];void 0!==c&&(r.splice(c,1),t())},set:function(e,c,n){var a;!1!==c?((a=!!u[e]&&r[u[e]])?(r[u[e]].value=c,r[u[e]].score=o++,"function"==typeof n&&(a.callback=n)):(a={key:e,value:c,score:o++},"function"==typeof n&&(a.callback=n),r.push(a)),t()):this.unset(e)},get:function(e){return"number"==typeof u[e]?(r[u[e]].score=++o,r[u[e]].value):null}}},"@VERSION@");YUI.add("datatype-xml-parse",function(e,t){e.mix(e.namespace("XML"),{parse:function(t){var n=null,r;return typeof t=="string"&&(r=e.config.win,r.ActiveXObject!==undefined?(n=new ActiveXObject("Microsoft.XMLDOM"),n.async=!1,n.loadXML(t)):r.DOMParser!==undefined?n=(new DOMParser).parseFromString(t,"text/xml"):r.Windows!==undefined&&(n=new Windows.Data.Xml.Dom.XmlDocument,n.loadXml(t))),n===null||n.documentElement===null||n.documentElement.nodeName==="parsererror",n}}),e.namespace("Parsers").xml=e.XML.parse,e.namespace("DataType"),e.DataType.XML=e.XML},"3.16.0");
YUI.add("io-xdr",function(e,t){function a(e,t,n){var r='<object id="io_swf" type="application/x-shockwave-flash" data="'+e+'" width="0" height="0">'+'<param name="movie" value="'+e+'">'+'<param name="FlashVars" value="yid='+t+"&uid="+n+'">'+'<param name="allowScriptAccess" value="always">'+"</object>",i=s.createElement("div");s.body.appendChild(i),i.innerHTML=r}function f(t,n,r){return n==="flash"&&(t.c.responseText=decodeURI(t.c.responseText)),r==="xml"&&(t.c.responseXML=e.DataType.XML.parse(t.c.responseText)),t}function l(e,t){return e.c.abort(e.id,t)}function c(e){return u?i[e.id]!==4:e.c.isInProgress(e.id)}var n=e.publish("io:xdrReady",{fireOnce:!0}),r={},i={},s=e.config.doc,o=e.config.win,u=o&&o.XDomainRequest;e.mix(e.IO.prototype,{_transport:{},_ieEvt:function(e,t){var n=this,r=e.id,s="timeout";e.c.onprogress=function(){i[r]=3},e.c.onload=function(){i[r]=4,n.xdrResponse("success",e,t)},e.c.onerror=function(){i[r]=4,n.xdrResponse("failure",e,t)},e.c.ontimeout=function(){i[r]=4,n.xdrResponse(s,e,t)},e.c[s]=t[s]||0},xdr:function(t,n,i){var s=this;return i.xdr.use==="flash"?(r[n.id]=i,o.setTimeout(function(){try{n.c.send(t,{id:n.id,uid:n.uid,method:i.method,data:i.data,headers:i.headers})}catch(e){s.xdrResponse("transport error",n,i),delete r[n.id]}},e.io.xdr.delay)):u?(s._ieEvt(n,i),n.c.open(i.method||"GET",t),setTimeout(function(){n.c.send(i.data)},0)):n.c.send(t,n,i),{id:n.id,abort:function(){return n.c?l(n,i):!1},isInProgress:function(){return n.c?c(n.id):!1},io:s}},xdrResponse:function(e,t,n){n=r[t.id]?r[t.id]:n;var s=this,o=u?i:r,a=n.xdr.use,l=n.xdr.dataType;switch(e){case"start":s.start(t,n);break;case"success":s.success(f(t,a,l),n),delete o[t.id];break;case"timeout":case"abort":case"transport error":t.c={status:0,statusText:e};case"failure":s.failure(f(t,a,l),n),delete o[t.id]}},_xdrReady:function(t,r){e.fire(n,t,r)},transport:function(t){t.id==="flash"&&(a(e.UA.ie?t.src+"?d="+(new Date).valueOf().toString():t.src,e.id,t.uid),e.IO.transports.flash=function(){return s.getElementById("io_swf")})}}),e.io.xdrReady=function(t,n){var r=e.io._map[n];e.io.xdr.delay=0,r._xdrReady.apply(r,[t,n])},e.io.xdrResponse=function(t,n,r){var i=e.io._map[n.uid];i.xdrResponse.apply(i,[t,n,r])},e.io.transport=function(t){var n=e.io._map["io:0"]||new e.IO;t.uid=n._uid,n.transport.apply(n,[t])},e.io.xdr={delay:100}},"3.16.0",{requires:["io-base","datatype-xml-parse"]});
YUI.add("page-title-helper",function(e){e.pageTitleHelper=function(r){var i="Flickr";return e.Lang.isString(r)&&(r=r.trim())&&(i=r+" | "+i),i}},"@VERSION@",{requires:[]});YUI.add("history-helper",function(t,e){var r=require("hermes-core/flog")(e);t.HistoryHelper={setData:function(t,e,i){var o={};if("undefined"!=typeof history&&history.replaceState){void 0!==history.state&&null!==history.state&&void 0!==history.state.flickr&&(o=history.state.flickr),void 0===o[t]&&(o[t]={}),o[t][e]=i;try{history.replaceState({flickr:o},"")}catch(t){}return!0}return r.warn("Failed attempt to store history data",{namespace:t,key:e}),!1},getData:function(t,e){var r;if("undefined"!=typeof history&&void 0!==history.state&&null!==history.state&&void 0!==history.state.flickr&&void 0!==(r=history.state.flickr[t])&&void 0!==r[e])return r[e]}}},"@VERSION@",{requires:[]});