YUI.add("person-relationship-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,i){var r=[],n={};return e.Lang.isObject(i,!0)&&(n.user_id=t,n.friend=this.getValue(t,"isFriend"),n.family=this.getValue(t,"isFamily"),"isContact"in i&&(i.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(n,this.appContext))),("isFriend"in i||"isFamily"in i)&&("isFriend"in i&&(n.friend=i.isFriend.newVal),"isFamily"in i&&(n.family=i.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(n,this.appContext))),"isIgnored"in i&&(!0===i.isIgnored.newVal?r.push(e.ModelUpdaters["flickr-contacts-block"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(n,this.appContext)))),e.Promise.all(r)}},toggleFollowing:function(e){this.getValue(e,"isContact")?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){this.getValue(e,"isFriend")?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){this.getValue(e,"isFamily")?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){this.getValue(e,"isIgnored")?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var i=this.appContext.getViewer();return!!i&&this.getValue(t,"nsid")===i.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});YUI.add("flickr-prefs-setSafeSearch-updater",function(e,r){"use strict";e.namespace("ModelUpdaters")["flickr-prefs-setSafeSearch"]={run:function(c,a){return a.callAPI("flickr.prefs.setSafeSearch",c).then(null,e.FetcherErrorLogger(r))}}},"@VERSION@",{requires:["flickr-promise"]});YUI.add("person-preferences-models",function(e){function t(e){t.superclass.constructor.call(this,e)}t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT=(t.UNIFIED_SEARCH_VIEW_TYPES={justified:"jst",thumbs:"thm",tiles:"til"}).justified,t.PHOTOSTREAM_VIEW_ORDER_DEFAULT=(t.PHOTOSTREAM_VIEW_ORDER_TYPES={dateposted:"dc",datetaken:"dt"}).dateposted,t.PHOTOSTREAM_VIEW_AS_TYPES={me:"me",friend:"fr",family:"fa",ff:"ff",public:"pu"},t.PHOTOSTREAM_VIEW_PREF_MAP={me:"me",fr:"friend",fa:"family",ff:"ff",pu:"public",dc:"dateposted",dt:"datetaken"},t.ALBUM_VIEW_LAYOUT_TYPES={justified:"justified",story:"story"},t.GALLERY_VIEW_LAYOUT_TYPES={large:"lv",justified:"jv",thumbnail:"tv"},t.ALBUM_VIEW_LAYOUT_DEFAULT=t.ALBUM_VIEW_LAYOUT_TYPES.story,t.GALLERY_VIEW_LAYOUT_DEFAULT=t.GALLERY_VIEW_LAYOUT_TYPES.large,t.PHOTOSTREAM_VIEW_AS_DEFAULT=t.PHOTOSTREAM_VIEW_AS_TYPES.public,e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,r){var i=[],n={};return e.Lang.isObject(r,!0)&&("safeSearch"in r?(n.safe_search=e.AttributeHelpers.coerceInteger(r.safeSearch.newVal)+1,i.push(e.ModelUpdaters["flickr-prefs-setSafeSearch"].run(n,this.appContext))):"photostreamViewOrderPref"in r||"photostreamViewAsPref"in r?(r.photostreamViewOrderPref&&(n.photostream_view_order_pref=r.photostreamViewOrderPref.newVal),r.photostreamViewAsPref&&(n.photostream_view_as_pref=r.photostreamViewAsPref.newVal),i.push(this.appContext.callAPI("flickr.prefs.setPrefs",n))):"albumViewLayoutPref"in r?(r.albumViewLayoutPref&&(n.album_view_layout=r.albumViewLayoutPref.newVal),i.push(this.appContext.callAPI("flickr.prefs.setPrefs",n))):"galleryViewLayoutPref"in r?(r.galleryViewLayoutPref&&(n.galleries_view_layout_pref=r.galleryViewLayoutPref.newVal),i.push(this.appContext.callAPI("flickr.prefs.setPrefs",n))):Object.keys(r).forEach(function(e){"unifiedSearchViewPref"===e?n.unified_search_view_pref=r.unifiedSearchViewPref.newVal:n[e]=r[e],i.push(this.appContext.callAPI("flickr.prefs.setPrefs",n))})),e.Promise.all(i)},readUserPrefs:function(e,t){return t.callAPI("flickr.feed.preferences.getUserPreferences",e,t).then(function(e){return e},function(e){})}},remoteReadUserPrefs:function(e,t,r){return this.remote.readUserPrefs(t,r).then(function(e){return e},function(e){})},attributes:{safeSearch:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},unifiedSearchViewPref:{validator:function(r){return!!e.AttributeHelpers.validateString(r)&&Object.keys(t.UNIFIED_SEARCH_VIEW_TYPES).some(function(e){return t.UNIFIED_SEARCH_VIEW_TYPES[e]===r})},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT},photostreamViewOrderPref:{validator:function(r){return!!e.AttributeHelpers.validateString(r)&&Object.keys(t.PHOTOSTREAM_VIEW_ORDER_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_ORDER_TYPES[e]===r})},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_ORDER_DEFAULT},photostreamViewAsPref:{validator:function(r){return!!e.AttributeHelpers.validateString(r)&&Object.keys(t.PHOTOSTREAM_VIEW_AS_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_AS_TYPES[e]===r})},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_AS_DEFAULT},albumViewLayoutPref:{validator:function(r){return!!e.AttributeHelpers.validateString(r)&&Object.keys(t.ALBUM_VIEW_LAYOUT_TYPES).some(function(e){return t.ALBUM_VIEW_LAYOUT_TYPES[e]===r})},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.ALBUM_VIEW_LAYOUT_DEFAULT},galleryViewLayoutPref:{validator:function(r){return!!e.AttributeHelpers.validateString(r)&&Object.keys(t.GALLERY_VIEW_LAYOUT_TYPES).some(function(e){return t.GALLERY_VIEW_LAYOUT_TYPES[e]===r})},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.GALLERY_VIEW_LAYOUT_DEFAULT}}},{getReadablePrefName:function(e){return t.PHOTOSTREAM_VIEW_PREF_MAP[e]},buildContextSuffix:function(t,r){var i=e.Models["person-preferences-models"].getReadablePrefName(t.getValue("photostreamViewOrderPref")),n=e.Models["person-preferences-models"].getReadablePrefName(t.getValue("photostreamViewAsPref"));return n===e.Models["person-preferences-models"].PHOTOSTREAM_VIEW_PREF_MAP.me||t.id!==r?i:i+"-"+n}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-prefs-setSafeSearch-updater","attribute-helpers"]});YUI.add("person-profile-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{nsid:{readOnly:!0,defaultFn:function(e){return e}},photoCount:{},unreadMessages:{},storageUsed:{},storageTotal:{},coverPhotoUrls:{},location:{},arrPhotoCount:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher"]});YUI.add("flickr-groups-join-creator",function(r,o){"use strict";r.namespace("ModelCreators")["flickr-groups-join"]={run:function(e,i){var u={};return u.group_id=e.groupModel.id,u.accept_rules=e.acceptRules,r.Promise.all([i.callAPI("flickr.groups.join",u)]).then(function(r){if("ok"===r[0].stat)return e.groupModel.join(),e.groupModel},r.FetcherErrorLogger(o))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("flickr-groups-leave-deletor",function(e,r){"use strict";e.namespace("ModelDeletors")["flickr-groups-leave"]={run:function(o,l){var t={};return t.group_id=o.groupModel.id,t.delete_photos=o.deletePhotos,e.Promise.all([l.callAPI("flickr.groups.leave",t)]).then(function(e){if("ok"===e[0].stat)return o.groupModel.leave(),o.groupModel},e.FetcherErrorLogger(r))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("photo-engagement-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},update:e.PhotoModelHelper.updateEngagement,delete:function(t){return e.ModelUpdaters["flickr-favorites-remove"].run(t,this.appContext)}},toggleFave:e.PhotoModelHelper.toggleFave,addAsFave:e.PhotoModelHelper.addAsFave,attributes:{ownerNsid:e.PhotoModelHelper.attributes.ownerNsid,isFaved:e.PhotoModelHelper.attributes.isFaved,faveCount:e.PhotoModelHelper.attributes.faveCount,commentCount:e.PhotoModelHelper.attributes.commentCount,canFave:e.PhotoModelHelper.attributes.canFave,canShare:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canDownload:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},noteCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},viewCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return(t=e.AttributeHelpers.coerceInteger(t))<0&&(t=0),t},defaultValue:0},isOwner:{readOnly:!0,derivedBy:["owner"],getter:function(e,t){var r=this.appContext.getViewer();return!!r.signedIn&&this.getValue(t,"ownerNsid")===r.nsid}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","photo-model-helper","flickr-photos-getInfo-fetcher","flickr-favorites-add-updater","flickr-favorites-remove-updater","attribute-helpers"]});YUI.add("flickr-photos-setDates-updater",function(t,e){"use strict";var a=require("hermes-core/flog")(e);t.namespace("ModelUpdaters")["flickr-photos-setDates"]={run:function(o,r){var d={};return o.fullResponse?(d.photo_ids=o.photoId,d.full_response=1):d.photo_id=o.photoId,o.dateTakenPartial&&(d.partial_date_taken=o.dateTakenPartial),o.datePostedPartial&&(d.partial_date_posted=o.datePostedPartial),o.datePosted&&(d.date_posted=o.datePosted),o.dateTaken&&(d.date_taken=o.dateTaken),o.takenGranularity>=0&&o.takenGranularity<=10&&(d.date_taken_granularity=o.takenGranularity),t.Promise.all([r.callAPI("flickr.photos.setDates",d),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photostream-models")]).then(function(t){var e,d=t[0],n=t[1],s=t[2],l={};if(s.attributeSearch({normalizedId:r.getViewer().nsid},!0).forEach(function(t){s.remove(t)}),e=d.errors,o.fullResponse){if(e&&d.errors.length>0)return e}else{if(!n.exists(o.photoId))throw new Error("[flickr-photos-setDates-updater] - Photo-stats model can not be updated if it does not exist");d.photo&&(d.photo.datePosted||d.photo.dateTaken)||a.warn("No updated data returned from API."),d.photo?(d.photo.datePosted&&(l.datePosted=d.photo.datePosted.content),d.photo.dateTaken&&(l.dateTaken=d.photo.dateTaken.content,l.takenGranularity=d.photo.dateTakenGranularity.content)):(o.datePosted&&(l.datePosted=o.datePosted),o.dateTaken&&(l.dateTaken=o.dateTaken),o.takenGranularity&&(l.takenGranularity=o.takenGranularity)),Object.keys(l).length>0&&n.setValues(o.photoId,l)}},function(t){throw o.fullResponse&&(t.photoIds=o.photoId),t}).then(null,t.FetcherErrorLogger(e))}}},"@VERSION@",{requires:["flickr-promise"],optional:[]});