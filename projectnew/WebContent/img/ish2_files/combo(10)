YUI.add("hermes-template-upload-limit-warning",function(a,e){var t=a.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(a,e,t,n,l){var s=null!=e?e:{},i=t.helperMissing,r=a.escapeExpression;return'<div class="upload-limit-warning">\n\t<header>\n\t\t<h1>'+r((t.intlMessage||e&&e.intlMessage||i).call(s,{name:"intlMessage",hash:{intlName:"upload-blocking.UPLOADS_LOCKED_SOON"},data:l}))+'</h1>\n\t</header>\n\t<div class="description-container">\n\t\t<p>\n\t\t\t<span>'+r((t.intlMessage||e&&e.intlMessage||i).call(s,{name:"intlMessage",hash:{limitCount:(t.friendlyNumber||e&&e.friendlyNumber||i).call(s,1e3,{name:"friendlyNumber",hash:{},data:l}),intlName:"upload-blocking.FREE_ACCOUNTS_NO_LONGER_UPLOAD_BY_1_8_2019"},data:l}))+'</span>\n\t\t\t<a target="_blank" href="https://blog.flickr.net/en/2018/12/17/important-service-updates-and-dates-to-remember/?utm_campaign=flickr-launch-15&utm_source=Flickr&utm_medium=product&utm_content=big-blue">'+r((t.intlMessage||e&&e.intlMessage||i).call(s,{name:"intlMessage",hash:{intlName:"upload-blocking.LEARN_MORE_ABOUT_CHANGES_HERE"},data:l}))+"</a>\n\t\t\t<span>"+r((t.intlMessage||e&&e.intlMessage||i).call(s,{name:"intlMessage",hash:{couponCode:"FLICKRPRO15",percentOff:"15",intlName:"upload-blocking.UPGRADE_TO_GET_UNLIMITED_BY_1_8_2019"},data:l}))+'</span>\n\t\t</p>\n\t</div>\n\t<div class="action-container">\n\t\t<a role="button" class="secondary-action">'+r((t.intlMessage||e&&e.intlMessage||i).call(s,{name:"intlMessage",hash:{intlName:"common.REMIND_ME_LATER"},data:l}))+'</a>\n\t\t<a class="primary-action" href="/account/upgrade/pro">'+r((t.intlMessage||e&&e.intlMessage||i).call(s,{name:"intlMessage",hash:{intlName:"common.GET_FLICKR_PRO"},data:l}))+"</a>\n\t</div>\n</div>\n"},useData:!0}),n={};a.Array.each([],function(e){var t=a.Template.get("hermes/"+e);t&&(n[e]=t)}),a.Template.register("hermes/upload-limit-warning",function(e,l){return l=l||{},l.partials=l.partials?a.merge(n,l.partials):n,t(e,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-upload-limit-message",function(e,a){var t=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,t,n,r){var l,i=null!=a?a:{},s=t.helperMissing,c=e.escapeExpression;return'<div class="upload-limit-message">\n\t<header>\n\t\t<h1>'+c("function"==typeof(l=null!=(l=t.title||(null!=a?a.title:a))?l:s)?l.call(i,{name:"title",hash:{},data:r}):l)+'</h1>\n\t</header>\n\t<p class="description">\n\t\t'+c((t.renderTrustedMarkup||a&&a.renderTrustedMarkup||s).call(i,null!=a?a.description:a,{name:"renderTrustedMarkup",hash:{},data:r}))+'\n\t</p>\n\t<div class="action-container">\n\t\t<a role="button" class="secondary-action">'+c("function"==typeof(l=null!=(l=t.secondaryActionText||(null!=a?a.secondaryActionText:a))?l:s)?l.call(i,{name:"secondaryActionText",hash:{},data:r}):l)+'</a>\n\t\t<a class="primary-action" href="/account/upgrade/pro">'+c("function"==typeof(l=null!=(l=t.primaryActionText||(null!=a?a.primaryActionText:a))?l:s)?l.call(i,{name:"primaryActionText",hash:{},data:r}):l)+"</a>\n\t</div>\n</div>\n"},useData:!0}),n={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)}),e.Template.register("hermes/upload-limit-message",function(a,r){return r=r||{},r.partials=r.partials?e.merge(n,r.partials):n,t(a,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-print-order-confirmation",function(t,e){var n=t.Template.Handlebars.revive({1:function(t,e,n,a,s){return'\t\t \t<p class="order-num-line">\n\t\t \t\t'+t.escapeExpression((n.intlHTMLMessage||e&&e.intlHTMLMessage||n.helperMissing).call(null!=e?e:{},{name:"intlHTMLMessage",hash:{orderUrl:null!=e?e.orderUrl:e,orderNum:null!=e?e.orderNum:e,intlName:"prints.YOUR_ORDER_NUMBER_IS"},data:s}))+"\n\t\t \t</p>\n"},3:function(t,e,n,a,s){return'\t\t \t<p class="order-email-line">\n\t\t \t\t'+t.escapeExpression((n.intlHTMLMessage||e&&e.intlHTMLMessage||n.helperMissing).call(null!=e?e:{},{name:"intlHTMLMessage",hash:{email:null!=e?e.email:e,intlName:"prints.YOULL_RECEIVE_ORDER_EMAIL"},data:s}))+"\n\t\t \t</p>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,a,s){var l,i,r=null!=e?e:{},o=n.helperMissing,c=t.escapeExpression;return'<div class="print-order-confirmation-container">\n\t<img class="confirmation-image"\n\t\tsrc="'+c("function"==typeof(i=null!=(i=n.assetRoot||(null!=e?e.assetRoot:e))?i:o)?i.call(r,{name:"assetRoot",hash:{},data:s}):i)+'/images/checkmark.png"\n\t\tsrcset="'+c("function"==typeof(i=null!=(i=n.assetRoot||(null!=e?e.assetRoot:e))?i:o)?i.call(r,{name:"assetRoot",hash:{},data:s}):i)+"/images/checkmark.png 1x, "+c("function"==typeof(i=null!=(i=n.assetRoot||(null!=e?e.assetRoot:e))?i:o)?i.call(r,{name:"assetRoot",hash:{},data:s}):i)+'/images/checkmark@2x.png 2x" />\n\n \t<h2 class="confirmation-title">\n \t\t'+c((n.intlMessage||e&&e.intlMessage||o).call(r,{name:"intlMessage",hash:{intlName:"prints.THANKS_FOR_YOUR_ORDER"},data:s}))+'\n \t</h2>\n \t<div class="confirmation-details">\n'+(null!=(l=n.if.call(r,null!=e?e.orderUrl:e,{name:"if",hash:{},fn:t.program(1,s,0),inverse:t.noop,data:s}))?l:"")+(null!=(l=n.if.call(r,null!=e?e.email:e,{name:"if",hash:{},fn:t.program(3,s,0),inverse:t.noop,data:s}))?l:"")+'\t \t<p class="questions-line">\n\t \t\t'+c((n.intlHTMLMessage||e&&e.intlHTMLMessage||o).call(r,{name:"intlHTMLMessage",hash:{helpUrl:null!=e?e.helpUrl:e,intlName:"prints.HAVE_QUESTIONS_LINE"},data:s}))+'\n\t \t</p>\n\n\t \t<p class="feedback-line">\n\t \t\t'+c((n.intlHTMLMessage||e&&e.intlHTMLMessage||o).call(r,{name:"intlHTMLMessage",hash:{feedbackUrl:null!=e?e.feedbackUrl:e,intlName:"prints.WE_WELCOME_FEEDBACK_HERE"},data:s}))+'\n\t \t</p>\n\t </div>\n \t<div class="confirmation-button-container">\n \t\t<button class="button accept-button">\n \t\t\t'+c((n.intlMessage||e&&e.intlMessage||o).call(r,{name:"intlMessage",hash:{intlName:"common.OK"},data:s}))+"\n \t\t</button>\n \t</div>\n </div>\n"},useData:!0}),a={};t.Array.each([],function(e){var n=t.Template.get("hermes/"+e);n&&(a[e]=n)}),t.Template.register("hermes/print-order-confirmation",function(e,s){return s=s||{},s.partials=s.partials?t.merge(a,s.partials):a,n(e,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-intro-to-prints",function(a,e){var t=a.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(a,e,t,n,s){var r=null!=e?e:{},i=t.helperMissing,l=a.escapeExpression;return'<div class="intro-to-prints-container">\n    <div class="main-content-container">\n        <div class="prints-img"></div>\n        <p class="title">'+l((t.preventOrphans||e&&e.preventOrphans||i).call(r,(t.intlMessage||e&&e.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"prints.GET_PRINTS_WALL_ART_TITLE"},data:s}),{name:"preventOrphans",hash:{},data:s}))+'</p>\n        <p class="body-text">'+l((t.intlMessage||e&&e.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"prints.GET_PRINTS_WALL_ART_DESCRIPTION"},data:s}))+'</p>\n        <button type="button" class="button accept-button">'+l((t.intlMessage||e&&e.intlMessage||i).call(r,{name:"intlMessage",hash:{intlName:"prints.SELECT_FROM_YOUR_PHOTOS"},data:s}))+'</button>\n    </div>\n    <div class="sub-note-container">\n        <span class="photo-attribution">Photos by <a href="/photos/lochthyme/16899518284/" target="_blank">Andrea Koerner</a>, <a href="/photos/lukestandridge/13150574814/" target="_blank">Luke Standridge</a>, and <a href="/photos/on1stsite/4673084428/" target="_blank">Marja van Bochove</a>; CC BY</span>\n    </div>\n</div>\n'},useData:!0}),n={};a.Array.each([],function(e){var t=a.Template.get("hermes/"+e);t&&(n[e]=t)}),a.Template.register("hermes/intro-to-prints",function(e,s){return s=s||{},s.partials=s.partials?a.merge(n,s.partials):n,t(e,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-helper",function(e){function t(e,t){var a;for(a in l){if(!t&&a===e)return l[a];if(t&&l[a]===e)return a}}var a=require("hermes-core/type-validator"),s=["q","ss","ct","mt","l","s","w","d","m","hd","b","a","g","e","cm","xel","xeh","xal","xah","xfl","xfh","eui"],r={userId:"user_id",groupId:"group_id",groupPathAlias:"group_path_alias",setId:"set_id",page:"page",text:"text",tags:"tags",tagMode:"tag_mode",sort:"sort",safeSearch:"safe_search",contentType:"content_type",mediaType:"media",license:"license",faves:"faves",contacts:"contacts",getty:"is_getty",commons:"is_commons",marketplace:"marketplace_licensable",minTakenDate:"min_taken_date",maxTakenDate:"max_taken_date",minUploadDate:"min_upload_date",maxUploadDate:"max_upload_date",hasGeo:"has_geo",boundingBox:"bbox",accuracy:"accuracy",woeId:"woe_id",camera:"camera",minExposure:"exif_min_exposure",maxExposure:"exif_max_exposure",minAperture:"exif_min_aperture",maxAperture:"exif_max_aperture",minFocalLength:"exif_min_focallen",maxFocalLength:"exif_max_focallen",excludeUserId:"exclude_user_id",foursquareWoeId:"foursquare_woeid",foursquareVenueId:"foursquare_venueid",slideshowStartId:"jump_to",height:"height",width:"width",dimensionSearchMode:"dimension_search_mode",orientation:"orientation",colorCodes:"color_codes",styles:"styles",similarityId:"similarity_id"},n={relevant:"relevance",recent:"date-posted-desc",interesting:"interestingness-desc",name:"exact-name-match-first",activity:"most-activity",size:"most-members",oldest:"oldest-first",newest:"recent-first",oldestJoined:"age",mostPhotos:"pho",dateUploaded:"date-posted-desc",dateTaken:"date-taken-desc"},o=["s","q","see","m"],i={username:"username",userId:"user_id",sort:"sort"},c=["q","s","m"],d={text:"text",sort:"sort",safeSearch:"safe_search",userId:"user_id",subscriptionTypes:"subscription_types",filterInactive:"filter_inactive_groups"},l={all:"0,1,2,3,4,5,6,7,8,9,10",cc:"1,2,3,4,5,6,9",deriv:"1,2,4,5,9,10",comm:"4,5,6,9,10",commderiv:"4,5,9,10"},u=[r.tags,r.tagMode,r.mediaType,r.minTakenDate,r.maxTakenDate,r.minUploadDate,r.maxUploadDate,r.height,r.width,r.dimensionSearchMode,r.orientation,r.marketplace,r.excludeUserId],m=[r.colorCodes,r.styles],p=[r.sort,r.safeSearch,r.license],h=[r.userId,r.groupId,r.faves,r.contacts,r.commons,"m","w"],f=[r.userId,r.groupId,r.faves,r.contacts,r.safeSearch,r.sort,r.license,r.tags,r.text],g={sort:n.relevant,parse_tags:"1",content_type:"7"};e.SearchHelper={API:r,PEOPLE_SEARCH_API:i,GROUPS_SEARCH_API:d,GROUPS_SAFE_SEARCH_SETTINGS:{safe:1,all:2,eighteenPlusOnly:3},API_SORT_OPTIONS:n,API_ORIENTATION_OPTIONS:{portrait:"portrait",square:"square",landscape:"landscape",panorama:"panorama"},LICENSE_TYPE:l,UNIFIED_STATE_PARAMS:{viewAll:"view_all",viewType:"view_type",advanced:"advanced",albums:"album_search"},UNIFIED_ADVANCED_PARAMS:u,UNIFIED_QUICK_FILTER_PARAMS:m,UNIFIED_TOOLBAR_PARAMS:p,SEARCH_SCOPE_PARAMS:h,UNIFIED_DEFAULT_PARAMS:g,decodeContentType:function(e){var t={};switch(parseInt(e,10)){case 1:t.photos=!0;break;case 2:t.screenshots=!0;break;case 3:t.other=!0;break;case 4:t.photos=!0,t.screenshots=!0;break;case 5:t.other=!0,t.screenshots=!0;break;case 6:t.photos=!0,t.other=!0;break;default:t.photos=!0,t.screenshots=!0,t.other=!0}return t},encodeContentType:function(e){var t=0;return!e.photos||e.screenshots||e.other?e.photos||!e.screenshots||e.other?e.photos||e.screenshots||!e.other?e.photos&&e.screenshots&&!e.other?t=4:!e.photos&&e.screenshots&&e.other?t=5:e.photos&&!e.screenshots&&e.other?t=6:e.photos&&e.screenshots&&e.other&&(t=7):t=3:t=2:t=1,t},isParameterlessSearch:function(e){return!(e[r.userId]||e[r.groupId]||e[r.tags]||e[r.text]||e[r.license]||e[r.faves]||e[r.contacts]||e[r.getty]||e[r.commons]||e[r.minTakenDate]||e[r.maxTakenDate]||e[r.minUploadDate]||e[r.maxUploadDate]||e[r.hasGeo]||e[r.boundingBox]||e[r.woeId]||e[r.camera]||e[r.minExposure]||e[r.maxExposure]||e[r.minAperture]||e[r.maxAperture]||e[r.minFocalLength]||e[r.maxFocalLength]||e[r.foursquareWoeId]||e[r.foursquareVenueId]||e[i.username]||e[r.similarityId])},mapRouteParamsToAPI:function(e){var t,s={nsid_or_path_alias:"userId",group_id:"groupId",set_id:"setId",page_number:"page",tag_list:"tags",location:"text",slideshow_start_id:"slideshowStartId"},n={};for(t in s)e[t]&&(n[r[s[t]]]=e[t]);return n[r.groupId]&&!a.nsid(n[r.groupId])&&(n[r.groupPathAlias]=n[r.groupId],delete n[r.groupId]),n},convertLicenseTypeValue:t,mapClassicSearchToAPI:function(t,o){if(!t)return{};var i,c,d,u,m={},p=o.getViewer(),h=t.l,f=t.s,g=t.w,_=t.m,I=t.q;if(t.d&&"string"==typeof t.d&&(d=t.d.split("-")),t.q&&(m[r.text]=t.q),void 0!==t.ss&&(m[r.safeSearch]=parseInt(t.ss,10)+1),void 0!==t.ct&&(m[r.contentType]=parseInt(t.ct,10)+1),void 0!==t.mt&&(m[r.mediaType]=t.mt),t.b&&(m[r.boundingBox]=t.b),t.a&&(m[r.accuracy]=t.a),t.e&&(m[r.woeId]=t.e),t.g&&(m[r.groupId]=t.g),t.cm&&(m[r.camera]=t.cm),void 0!==t.xel&&(m[r.minExposure]=t.xel),void 0!==t.xeh&&(m[r.maxExposure]=t.xeh),void 0!==t.xal&&(m[r.minAperture]=t.xal),void 0!==t.xah&&(m[r.maxAperture]=t.xah),void 0!==t.xfl&&(m[r.minFocalLength]=t.xfl),void 0!==t.xfh&&(m[r.maxFocalLength]=t.xfh),t.eui&&(m[r.excludeUserId]=t.eui),void 0!==h)switch(h){case"cc":case"comm":case"deriv":case"commderiv":m[r.license]=l[h];break;default:(c=parseInt(h,10))>=0&&c<=10&&(m[r.license]=c)}if(f)switch(f){case"rec":m[r.sort]=n.recent;break;case"rel":m[r.sort]=n.relevant;break;case"int":m[r.sort]=n.interesting}if(t.hd&&(m[r.media]="hdvideo"),g&&"string"==typeof g)if(-1!==g.indexOf("faves"))u=g.split("-"),m[r.faves]=1,u.length>1?m[r.userId]=u[1]:p.signedIn&&(m[r.userId]=p.nsid);else if(a.nsid(g))"pool"===_?m[r.groupId]=g:m[r.userId]=g;else switch(g){case"contacts":m[r.contacts]="all";break;case"ff":m[r.contacts]="ff";break;case"getty":m[r.getty]="true";break;case"commons":m[r.commons]="true";break;case"usg":m[r.license]=8}if(d)switch(d[0]){case"taken":d[1]&&(m[r.minTakenDate]=e.flutil.parseYYYYMMDDDatestamp(d[1])/1e3),d[2]&&(m[r.maxTakenDate]=e.flutil.parseYYYYMMDDDatestamp(d[2])/1e3);break;case"posted":d[1]&&(m[r.minUploadDate]=e.flutil.parseYYYYMMDDDatestamp(d[1])/1e3),d[2]&&(m[r.maxUploadDate]=e.flutil.parseYYYYMMDDDatestamp(d[2])/1e3)}if(_&&I)switch(_){case"tags":delete(m=e.merge(m,this.processTags(I)))[r.text]}for(i in t)-1===s.indexOf(i)&&(m[i]=t[i]);return m},mapClassicPeopleSearchToAPI:function(e,t){var a={},s=null,r=t.getViewer();if((e=e||{}).q&&(a[i.username]=e.q),e.s)switch(e.s){case"age":a[i.sort]=n.oldestJoined;break;case"pho":a[i.sort]=n.mostPhotos}e.see&&"all"===e.see.toString().toLowerCase()&&r.signedIn&&(a[i.userId]=r.nsid),e.m&&(e.m.toString().toLowerCase(),e.m.toString().toLowerCase());for(s in e)-1===o.indexOf(s)&&(a[s]=e[s]);return a},mapClassicGroupSearchToApi:function(e,t){var a,s={},r=null;if(e=e||{},a=e.m&&"discuss"===e.m.toString().toLowerCase(),e.q&&(s[d.text]=e.q),e.s)switch(e.s){case"act":s[d.sort]=a?n.discussionActivity:n.activity;break;case"siz":s[d.sort]=n.size;break;case"age":s[d.sort]=n.newest}for(r in e)-1===c.indexOf(r)&&(s[r]=e[r]);return s},mapAPIParamsToAdvancedSearchQuery:function(e){var a={},s=e[r.userId];return e[r.text]?a.q=e[r.text]:e[r.tags]&&(a.q=e[r.tags]),e[r.faves]?a.w=s?"faves-"+s:"faves":s?a.w=s:"all"===e[r.contacts]?a.w="contacts":"ff"===e[r.contacts]?a.w="ff":"true"===e[r.getty]?a.w="getty":"true"===e[r.commons]?a.w="commons":8===parseInt(e[r.license],10)&&(a.w="usg"),e[r.license]&&(a.l=t(e[r.license],!0)),a},deriveScopeTitle:function(t,s){var n,o=s.getViewer();return t[r.userId]?o&&o.signedIn&&o.nsid===t[r.userId]?t[r.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.YOUR_PHOTOS"}):(n=a.nsid(t[r.userId])?t[r.userId]:{pathAlias:t[r.userId]},s.getModel("person-models",n).then(function(e){var a;return a=t[r.faves]?"search.FAVES_POSSESSIVE":"search.PHOTOS_POSSESSIVE",{intlName:a,name:e.getValue("displayname")}})):t[r.contacts]?e.Promise.resolve({intlName:"search.FROM_PEOPLE_YOU_FOLLOW"}):t[r.groupId]||t[r.groupPathAlias]?(n=t[r.groupId]?{id:t[r.groupId]}:{pathAlias:t[r.groupPathAlias]},s.getModel("group-info-models",n).then(function(e){return{intlName:"search.IN_GROUP_POOL",name:e.getValue("group").getValue("title")}})):t[r.faves]?e.Promise.resolve({intlName:"search.VIEWER_FAVES"}):e.Promise.resolve({intlName:"search.EVERYONES_PHOTOS"})},derivePeopleScopeTitle:function(t,s){var n,o=s.getViewer();if(t[r.userId])return o&&o.signedIn&&o.nsid===t[r.userId]?e.Promise.resolve({intlName:"search.PEOPLE_YOU_FOLLOW"}):(n=a.nsid(t[r.userId])?t[r.userId]:{pathAlias:t[r.userId]},s.getModel("person-models",n).then(function(e){return{intlName:"search.CONTACTS_POSSESSIVE",name:e.getValue("username")}}))},deriveGroupsScopeTitle:function(t,s){var n,o=s.getViewer();if(t[r.userId])return o&&o.signedIn&&o.nsid===t[r.userId]?e.Promise.resolve({intlName:"search.YOUR_GROUPS"}):(n=a.nsid(t[r.userId])?t[r.userId]:{pathAlias:t[r.userId]},s.getModel("person-models",n).then(function(e){return{intlName:"search.GROUPS_POSSESSIVE",name:e.getValue("username")}}))},deriveCCLicenseString:function(e){e||(e={});var t=null,a=e[r.license];if(a&&1===a.length)switch(parseInt(a,10)){case 1:t="search.CC_BY_NC_SA";break;case 2:t="search.CC_BY_NC";break;case 3:t="search.CC_BY_NC_ND";break;case 4:t="search.CC_BY";break;case 5:t="search.CC_BY_SA";break;case 6:t="search.CC_BY_ND"}return t?{intlName:t}:null},addParamDefaults:function(e,t){!e[r.license]||e[r.license]!==l.all&&""!==e[r.license]||delete e[r.license]},addGroupsParamDefaults:function(e){},addPeopleParamDefaults:function(e){},clearParams:function(e,t){for(var a in e)-1===t.indexOf(a)&&delete e[a]},clearAdvancedSearchParams:function(e){this.clearParams(e,f)},clearParamsExceptSearchScope:function(e){this.clearParams(e,h)},generateQueryString:function(t){var a=e.clone(t)||{};return delete a.page,delete a.method,delete a.extras,e.QueryString.stringify(a)},convertSafeSearchPrefsToApi:function(t){var a=e.AttributeHelpers.coerceInteger(t);return e.AttributeHelpers.coerceString(a+1)},unescapeParameters:function(t){var a=t[r.groupId],s=t[r.tags],n=t[r.text];YUI.Env.isServer&&(a&&(t[r.groupId]=e.flutil.unescape(a)),s&&(t[r.tags]=e.flutil.unescape(s)),n&&(t[r.text]=e.flutil.unescape(n)))},objectsAreEquivalentToDepth:function(t,a,s){var r,n,o=this;return t===a||!(s<=0)&&(s=s||1,!(!e.Lang.isObject(t)||!e.Lang.isObject(a))&&(r=Object.keys(t),n=Object.keys(a),r.length===n.length&&r.every(function(e){return o.objectsAreEquivalentToDepth(t[e],a[e],s-1)})))},normalizeTag:function(e){var t;return e&&(t=e.replace(/[\s!-\/:-@[-`]/g,"")),t},processTags:function(e,t){if(!e||"string"!=typeof e)return{};var a,s,n,o,i={},c=/(["'])(\\?.)*?\1/g,d=/^([,\+]|AND|OR)$/;return a=e.match(c)||[],s=e.replace(c,""),n=s.split(/[,\+\s]/),n=n.map(function(e){return e.trim()}).filter(function(e){return e&&!d.test(e)}),o=a.concat(n),i[r.tags]=o.join(","),"any"===t||"all"===t?i[r.tagMode]=t:/[\+\s]OR[\+\s]/.test(e)?(i[r.tagMode]="any",o.length=Math.min(o.length,11)):i[r.tagMode]="all",i}}},"@VERSION@",{requires:["flutil"]});YUI.add("search-url",function(e,r){function s(e){return"number"==typeof e?e.toString():"boolean"==typeof e?e?"1":"0":"string"==typeof e?e:void 0}var t,a,h=require("hermes-core/flog")(r),o=/^\/search(?:\/.*)?$/,i=/^bw|blackandwhite$/;t=YUI.Env.isServer?require("querystring").stringify:e.QueryString.stringify,(a=function(r,t,o){var i,c,p,n,P;if(this.appContext=t,"string"==typeof r){if(P=r.split("?"),o?this.searchType=o:(p=-1!==(c=P[0].split("/"))[0].indexOf("http")?3:1,n="/"+c.slice(p).join("/"),this.searchType=this.getSearchTypeFromPathname(n)),P=P.length>1?P[1]:"",this.params={},P)try{P=e.QueryString.parse(P),this.params=e.SearchHelper.mapClassicSearchToAPI(P,t)}catch(e){h.warn("malformed query",{err:e,query:P})}}else this.params=e.merge(r),this.searchType=o;for(i in this.params)this.params.hasOwnProperty(i)&&(this.params[i]=s(this.params[i]));this.params.color_codes&&(this.colors=this.params.color_codes.toString().split(",")),this.searchType||this.setSearchType(a.searchTypes.UNDEFINED)}).prototype.setSearchType=function(r){var s=this.getSearchTerm();return this.searchType=r,this.params=this.validateParams(this.params,this.searchType),this.params=e.merge(this.getDefaultParams(this.searchType),this.params),s&&this.setSearchTerm(s),this},a.prototype.getSearchTypeFromPathname=function(e){switch(e=e||this.pathname,e=e.toLowerCase(),e=e.split("/").join("")){case"searchpeople":return a.searchTypes.PEOPLE;case"searchgroups":return a.searchTypes.GROUPS;case"search":default:return a.searchTypes.PHOTOS}},a.prototype.getPathname=function(){var e="/search/";switch(this.searchType){case a.searchTypes.PEOPLE:e+="people/";break;case a.searchTypes.GROUPS:e+="groups/";break;case a.searchTypes.CLASSIC_GROUPS:e="/search_groups.gne";break;case a.searchTypes.PHOTOS:}return e},a.prototype.validateParams=function(r,s){var t,h,o,i={};switch(r=e.merge(r),s){case a.searchTypes.PEOPLE:(t=e.merge(e.SearchHelper.PEOPLE_SEARCH_API)).text="text";break;case a.searchTypes.GROUPS:t=e.merge(e.SearchHelper.GROUPS_SEARCH_API);break;case a.searchTypes.PHOTOS:t=e.merge(e.SearchHelper.API,e.SearchHelper.UNIFIED_STATE_PARAMS);break;case a.searchTypes.UNDEFINED:default:return r}if(t)for(h in t)void 0!==r[o=t[h]]&&(i[o]=r[o]);return i},a.prototype.getDefaultParams=function(r){var s={};switch(r){case a.searchTypes.PEOPLE:e.SearchHelper.addPeopleParamDefaults(s);break;case a.searchTypes.GROUPS:e.SearchHelper.addGroupsParamDefaults(s);break;case a.searchTypes.PHOTOS:e.SearchHelper.addParamDefaults(s);break;case a.searchTypes.UNDEFINED:}return s},a.prototype.getAPIParams=function(){return e.merge(this.params)},a.prototype.getAPIParam=function(e){return this.params[e]},a.prototype.setAPIParam=function(e,r){return this.params[e]=s(r),this},a.prototype.removeAPIParam=function(e){return delete this.params[e],this},a.prototype.removeAllAPIParams=function(){return this.params={},this},a.prototype.getSearchTerm=function(){var r=this.params[this.getSearchTermKey(this.searchType)];return r||(r=this.params[e.SearchHelper.API.tags]),r||""},a.prototype.setSearchTerm=function(r){var s=this.getSearchTermKey(this.searchType);return delete this.params[e.SearchHelper.PEOPLE_SEARCH_API.username],delete this.params[e.SearchHelper.GROUPS_SEARCH_API.text],delete this.params[e.SearchHelper.API.text],delete this.params[e.SearchHelper.API.tags],delete this.params.q,this.params[s]=r,this},a.prototype.getSearchTermKey=function(r){switch(r){case a.searchTypes.PEOPLE:return e.SearchHelper.PEOPLE_SEARCH_API.username;case a.searchTypes.GROUPS:return e.SearchHelper.GROUPS_SEARCH_API.text;case a.searchTypes.PHOTOS:default:return this.params[e.SearchHelper.API.tags]||""===this.params[e.SearchHelper.API.tags]?e.SearchHelper.API.tags:e.SearchHelper.API.text}},a.prototype.removeScope=function(){return e.SearchHelper.SEARCH_SCOPE_PARAMS.forEach(function(e){this.removeAPIParam(e)}.bind(this)),this.removeAPIParam(e.SearchHelper.API.excludeUserId),this},a.prototype.resetToUnified=function(){return this.params[e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll]&&(this.removeAPIParam(e.SearchHelper.API.userId),this.removeAPIParam(e.SearchHelper.API.contacts),this.removeAPIParam(e.SearchHelper.API.groupId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.albums)),this.removeAPIParam(e.SearchHelper.API.similarityId),this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.viewAll),this},a.prototype.hasAdvancedParams=function(r){return Object.keys(this.params).some(function(s){return-1!==e.SearchHelper.UNIFIED_ADVANCED_PARAMS.indexOf(s)||!r&&-1!==e.SearchHelper.UNIFIED_QUICK_FILTER_PARAMS.indexOf(s)||!r&&-1!==e.SearchHelper.UNIFIED_TOOLBAR_PARAMS.indexOf(s)})},a.prototype.resetAdvancedParam=function(r,s){return this.hasAdvancedParams(r)?this.setAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.advanced,1):s||this.removeAPIParam(e.SearchHelper.UNIFIED_STATE_PARAMS.advanced),this},a.prototype.createNewSearch=function(e){return this.setSearchTerm(e),this.removeScope(),this.searchType!==a.searchTypes.UNDEFINED&&this.searchType!==a.searchTypes.PHOTOS||(this.resetToUnified(),this.resetAdvancedParam()),this},a.prototype.getURL=function(){var e=this.getId(),r=this.getPathname();return e===a.EMPTY_SEARCH_ID?r:r+"?"+e},a.prototype.getId=function(){var r,s={},h=e.SearchHelper.API;for(r in this.params)h[r]?s[h[r]]=this.params[r]:s[r]=this.params[r];return t(s)||a.EMPTY_SEARCH_ID},a.prototype.clone=function(){return new a(this.params,this.appContext,this.searchType)},a.prototype.setMedia=function(r,s){var t;r||(r=!1),s||(s=!1),t=r&&s?"all":r?"photos":"videos",this.setAPIParam(e.SearchHelper.API.mediaType,t)},a.prototype._syncColors=function(){this.colors&&this.colors.length>0?this.params.color_codes=this.colors.join(","):this.removeAPIParam("color_codes")},a.prototype.addColorCode=function(e){if(e&&e.match(i))return this.clearColorCodes(),this.colors=["bw"],void this._syncColors();this.colors&&-1!==this.colors.indexOf("bw")&&(this.colors=[]),this.colors||(this.colors=[]),-1===this.colors.indexOf(e)&&(this.colors.push(e),this._syncColors())},a.prototype.removeColorCode=function(e){var r;this.colors&&-1!==(r=this.colors.indexOf(e))&&(this.colors.splice(r,1),this._syncColors())},a.prototype.clearColorCodes=function(){this.colors=[],this._syncColors()},a.isSearchUrl=function(e){return o.test(e)},a.searchTypes={UNDEFINED:0,PHOTOS:1,PEOPLE:2,GROUPS:3,CLASSIC_GROUPS:4},a.EMPTY_SEARCH_ID="-1",e.SearchUrl=a},"@VERSION@",{requires:["search-helper","querystring-parse-simple","querystring-stringify-simple"]});YUI.add("hermes-template-search-pill",function(a,e){var n=a.Template.Handlebars.revive({1:function(a,e,n,l,s){var i,r,t=null!=e?e:{},c=n.helperMissing,m=a.escapeExpression;return'<li class="search-pill" '+(null!=(i=n.if.call(t,null!=e?e.id:e,{name:"if",hash:{},fn:a.program(2,s,0),inverse:a.noop,data:s}))?i:"")+' title="'+m("function"==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name",hash:{},data:s}):r)+'">\n\t<span class="search-pill-name">'+m("function"==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name",hash:{},data:s}):r)+'</span>\n\t<div class="search-pill-divider"></div>\n\t<span class="search-pill-second-name" title="'+m("function"==typeof(r=null!=(r=n.secondName||(null!=e?e.secondName:e))?r:c)?r.call(t,{name:"secondName",hash:{},data:s}):r)+'">'+m("function"==typeof(r=null!=(r=n.secondName||(null!=e?e.secondName:e))?r:c)?r.call(t,{name:"secondName",hash:{},data:s}):r)+'</span>\n\t<i class="search-pill-remover"></i>\n</li>\n'},2:function(a,e,n,l,s){var i;return"id="+a.escapeExpression("function"==typeof(i=null!=(i=n.id||(null!=e?e.id:e))?i:n.helperMissing)?i.call(null!=e?e:{},{name:"id",hash:{},data:s}):i)},4:function(a,e,n,l,s){var i,r,t=null!=e?e:{},c=n.helperMissing,m=a.escapeExpression;return'<li class="search-pill" '+(null!=(i=n.if.call(t,null!=e?e.id:e,{name:"if",hash:{},fn:a.program(2,s,0),inverse:a.noop,data:s}))?i:"")+' title="'+m("function"==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name",hash:{},data:s}):r)+'"><span class="search-pill-name">'+m("function"==typeof(r=null!=(r=n.name||(null!=e?e.name:e))?r:c)?r.call(t,{name:"name",hash:{},data:s}):r)+'</span><i class="search-pill-remover"></i></li>\n'},compiler:[7,">= 4.0.0"],main:function(a,e,n,l,s){var i;return null!=(i=n.if.call(null!=e?e:{},null!=e?e.combo:e,{name:"if",hash:{},fn:a.program(1,s,0),inverse:a.program(4,s,0),data:s}))?i:""},useData:!0}),l={};a.Array.each([],function(e){var n=a.Template.get("hermes/"+e);n&&(l[e]=n)}),a.Template.register("hermes/search-pill",function(e,s){return s=s||{},s.partials=s.partials?a.merge(l,s.partials):l,n(e,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});